import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import style
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.model_selection import train_test_split
style.use('fivethirtyeight')

m=500
'''
print(np.random.randn(m,1))
print(np.random.rand(m,1))
print(np.random.randint(m))
'''
x=6*np.random.rand(m,1)-3
y=0.5*x**2+x+2+np.random.randn(m,1)

x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=10)
x_test=sorted(x_test,reverse=False)

def poly_reg(x_new):
    poly_features=PolynomialFeatures(degree=2,include_bias=False)
    x_poly=poly_features.fit_transform(x_new)
    return x_poly

def reg():
    slr=LinearRegression()
    slr.fit(poly_reg(x_train),y_train)
    y_pred=slr.predict(poly_reg(x_test))
    plt.scatter(x,y,color='red',marker='*',s=100)
    plt.plot(x_test,y_pred,marker='o',color='green')
    plt.show()
reg()    
    
    

