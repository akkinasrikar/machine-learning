import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import classification_report,confusion_matrix
import matplotlib.pyplot as plt
import seaborn as sns
sns.set_style('whitegrid')


titanic_dataset=pd.read_csv('full.csv')

titanic_dataset.drop(['Cabin','Body','Name_wiki','Destination','Lifeboat',
                      'Class','Age_wiki','Hometown','Boarded'],axis=1,inplace=True)

#exploring the data analysis
#print(titanic_dataset.isnull())
#print(titanic_dataset.info())
#sns.heatmap(titanic_dataset.isnull(),yticklabels=False,cbar=False,cmap='viridis')
#sns.countplot(titanic_dataset['Survived'],hue=titanic_dataset['Sex'])
#sns.distplot(titanic_dataset['Age'].dropna(),bins=30)

#sns.boxplot(x=titanic_dataset['Pclass'],y=titanic_dataset['Age'])
def imputing(cols):
    Age=cols[0]
    Pclass=cols[1]
    if pd.isnull(Age):
        if Pclass==1:
            return 39
        elif Pclass==2:
            return 29
        else:
            return 24
    else:
        return Age
titanic_dataset['Age']=titanic_dataset[['Age','Pclass']].apply(imputing,axis=1)          
titanic_dataset.dropna(inplace=True)    
#sns.heatmap(titanic_dataset.isnull(),yticklabels=False,cbar=False,cmap='viridis')
sex=pd.get_dummies(titanic_dataset['Sex'],drop_first=True)
embark=pd.get_dummies(titanic_dataset['Embarked'],drop_first=True)
titanic_dataset=pd.concat([titanic_dataset,sex,embark],axis=1)
titanic_dataset.drop(['Sex','Name','Ticket','PassengerId','Embarked'],axis=1,inplace=True)

x=titanic_dataset.iloc[:,1:]
y=titanic_dataset['Survived']

x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=5)

def log_reg():
    logistic=LogisticRegression()
    logistic.fit(x_train,y_train)
    y_pred=logistic.predict(x_test)
    print(confusion_matrix(y_test,y_pred))
    print(classification_report(y_test,y_pred))
    
log_reg()


#output

runfile('C:/Users/personal/Desktop/project/ridge_regression.pynb.py', wdir='C:/Users/personal/Desktop/project')
[[136  12]
 [ 19  56]]
              precision    recall  f1-score   support

           0       0.88      0.92      0.90       148
           1       0.82      0.75      0.78        75

    accuracy                           0.86       223
   macro avg       0.85      0.83      0.84       223
weighted avg       0.86      0.86      0.86       223